# Stage 2: FRW corridor analysis (Rungs 1–9)

**Status:** exploratory Stage 2 axis, fully downstream of Phase 3–4,  
**not** promoted into any phase paper (Phase 3–5) as of 2026-01-09.

This README documents the FRW corridor analysis built on top of the
Phase 4 FRW pipeline. It records what we have *actually done*,
what is structurally true of the current grid, and what is **not yet**
claimed physically.

---

## 1. Inputs and dependencies

This axis treats the Phase 4 FRW artifacts as **fixed inputs**:

- `phase4/outputs/tables/phase4_F1_frw_viability_mask.csv`
- `phase4/outputs/tables/phase4_F1_frw_lcdm_probe_mask.csv`
- `phase4/outputs/tables/phase4_F1_frw_shape_probe_mask.csv`
- `phase4/outputs/tables/phase4_F1_frw_data_probe_mask.csv`
- `phase4/outputs/tables/phase4_F1_frw_corridors.json`

These are generated by the Phase 4 FRW scripts and documented in the
Phase 4 paper reproducibility appendix.

All Stage 2 FRW rungs are implemented in:

- `stage2/frw_corridor_analysis/src/`
- outputs go to:
  - `stage2/frw_corridor_analysis/outputs/tables/`
  - `stage2/frw_corridor_analysis/outputs/figures/`

---

## 2. Rungs 1–9: what they do

### Rung 1 — Sources inventory

Script:
- `analyze_frw_corridor_v1.py`

Output:
- `stage2_frw_corridor_rung1_sources_v1.csv`

Purpose:
- Sanity-check presence, sizes, and basic metadata of all Phase 4 FRW
  mask / corridor inputs.
- Confirms that:
  - all expected CSV/JSON files exist,
  - they have the expected row/column counts,
  - the JSON corridors file is readable.

### Rung 2 — Boolean census

Script:
- `analyze_frw_corridor_bool_census_v1.py`

Output:
- `stage2_frw_corridor_rung2_bool_census_v1.csv`

Purpose:
- Automatically detect “boolean-like” columns in each FRW mask
  (values strictly in {0, 1}).
- For each such column, record:
  - number of `True` / `False` / NA entries,
  - fraction of the full grid.

Key structural facts:
- FRW viability and matter-era flags are widespread;
- `lcdm_like` and `shape_and_lcdm` are much rarer slices.

### Rung 3 — Family definitions

Script:
- `analyze_frw_corridor_families_v1.py`

Output:
- `stage2_frw_corridor_rung3_families_v1.csv`

Purpose:
- Define a small set of named FRW “families” on the θ-grid:

  - **F1_FRW_VIABLE**: FRW viability mask
  - **F2_LCDM_LIKE**: LCDM-like subset
  - **F3_TOY_CORRIDOR**: toy corridor subset
  - **F4_CORRIDOR_AND_VIABLE**: intersection of corridor and viability
  - **F5_CORRIDOR_AND_LCDM**: intersection of corridor and LCDM-like
  - **F6_DATA_OK**: data-OK subset (currently empty, since no FRW data
    file is bundled in Phase 4)

- For each family, record:
  - `n_theta` (number of θ-grid points),
  - `frac_of_grid` (fraction of the full θ-grid).

At this rung we learn the basic “width” of each family on the discrete grid.

### Rung 4 — Overlap matrix

Script:
- `analyze_frw_corridor_family_overlap_v1.py`

Output:
- `stage2_frw_corridor_rung4_family_overlap_v1.csv`

Purpose:
- Build a pairwise overlap table between all families (F1–F6).
- For each ordered pair (A, B), record:
  - counts and fractions of A∧B, A∧¬B, ¬A∧B, ¬A∧¬B.

This gives a compact view of how nested/overlapping these families are,
e.g. how much of the toy corridor is FRW-viable, etc.

### Rung 5 — Family visualization

Script:
- `plot_frw_corridor_families_v1.py`

Outputs (PDF figures):
- `stage2_frw_corridor_family_theta_hist_v1.pdf`
- `stage2_frw_corridor_family_omega_lambda_scatter_v1.pdf`

Purpose:
- Hard-figure view of the family masks:

  1. **θ histogram**: shows how many grid points in each family,
     as a function of θ.
  2. **ω_Λ vs θ scatter**: places family membership in the plane
     (θ, ω_Λ) using the Phase 4 shape-probe mask.

These figures are currently **Stage 2 only** and not referenced in
any phase paper.

### Rung 6 — Contiguity analysis

Script:
- `analyze_frw_corridor_contiguity_v1.py`

Output:
- `stage2_frw_corridor_rung6_contiguity_v1.csv`

Purpose:
- For each family, decompose its θ support into **contiguous segments**
  along the θ-grid.
- Record:
  - number of segments,
  - coverage of each segment (length, fraction of grid/family).

Result (current grid):
- F1_FRW_VIABLE is one contiguous segment.
- The other families (F2–F5) are represented by two segments each.

This establishes that the families are **geometric intervals**, not
randomly sprinkled points.

### Rung 7 — Stride robustness

Script:
- `analyze_frw_corridor_stride_robustness_v1.py`

Output:
- `stage2_frw_corridor_rung7_stride_robustness_v1.csv`

Purpose:
- Test robustness of each family under **subsampling** of the θ-grid
  by strides (1, 2, 4, 8).
- For each (family, stride), record:
  - effective grid size,
  - number of `True` points,
  - fraction of the subgrid and of the full grid,
  - number of contiguous segments.

Observation:
- The **fraction of the subgrid** remains very stable across strides,
  i.e. the families survive coarser sampling structurally.

### Rung 8 — Smoothing robustness

Script:
- `analyze_frw_corridor_smoothing_v1.py`

Output:
- `stage2_frw_corridor_rung8_smoothing_v1.csv`

Purpose:
- Apply simple 1D smoothing (window sizes 1, 3, 5) to each family mask,
  then re-threshold, and compare masks via **Jaccard overlap**.
- Record:
  - `n_true_before/after`,
  - `segments_before/after`,
  - Jaccard index.

Result:
- For all families and tested windows, the Jaccard index is 1.0 and
  segments are unchanged: the masks are **already smooth** at the
  current resolution.

### Rung 9 — Segments + θ\* alignment

Script:
- `analyze_frw_corridor_segments_theta_star_v1.py`

Outputs:
- `stage2_frw_corridor_rung9_segments_v1.csv`
- `stage2_frw_corridor_rung9_theta_star_alignment_v1.csv`

Purpose:
- Re-encode segment structure and measure how close any **family point**
  comes to the distinguished angle θ\* = φ^φ ≈ 2.178458.
- For each family:
  - record the closest θ on the grid to θ\*,
  - record |Δθ|.

Current result (summary):
- F1_FRW_VIABLE covers a broad region that **includes** a grid point
  very close to θ\* (|Δθ| ~ 2×10⁻⁴).
- For the narrower families (LCDM-like subsets, corridor∩LCDM, etc.),
  the nearest points lie much further away in θ (~1.1 rad).

**Important:** this is a **geometric alignment statement on the grid**,
not a physical claim about the actual universe.

---

## 3. What we *can* and *cannot* say

### We *can* say:

- The FRW families F1–F5 form robust, geometrically contiguous regions
  on the current θ-grid.
- These regions remain stable under:
  - sub-sampling of the grid (stride tests),
  - simple smoothing (window tests).
- The distinguished angle θ\* lies deep inside the broad FRW-viable
  family F1, but is not particularly special for the narrower families.

All of the above is **fully downstream** of Phase 4 artifacts and is
backed by specific Stage 2 tables and figures.

### We **cannot** yet say:

- That any of these corridors correspond to the *actual* universe,  
  because:

  - the FRW data mask (`data_ok`) is currently empty in Phase 4,
  - no real cosmological dataset is bundled or used,
  - we have not imposed a physical interpretation gate.

- That θ\* is physically preferred, even if it lies in a robust region:
  that would require a **promotion gate** combining:
  - external data,
  - robustness to parameter choices,
  - a clearly articulated, falsifiable physical claim.

Until such a gate is passed, all FRW corridor statements remain
**Stage 2 exploratory diagnostics**, not phase-level claims.

---

## 4. Relation to the broader roadmap

- This axis is part of **Stage 2**, not the original Phase 0–5 ladder.
- It probes how the Phase 3 mechanism + Phase 4 FRW pipeline carve out
  viable regions on θ, and how θ\* is positioned relative to them.
- Future rungs may:
  - incorporate real FRW distance data,
  - explore dependence on mechanism parameters,
  - define promotion candidates for:

    - **Option A:** a small, conservative FRW section in Phase 5, or
    - **Option B:** a dedicated FRW-focused phase/paper (Phase 6).

Promotion is governed by a separate **FRW corridor promotion gate**:

- `docs/FRW_CORRIDOR_PROMOTION_GATE_v1.md`

As of 2026-01-09, this gate is **not yet passed**.

