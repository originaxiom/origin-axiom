# Phase 4 FRW F1 Baseline Checkpoint (v1)

**Scope.** This note freezes the current Phase 4 FRW backbone for the
F1 mapping family, and records the overlap between:

- the Phase 4 F1 FRW viability mask,
- the F1 “shape corridor” (toy diagnostic on \(E_\mathrm{vac}(\theta)\)),
- the \(\Lambda\)CDM-like FRW submask, and
- the Stage 2 external–cosmo host age–corridor kernel exported for
  Phase 4.

All numbers and paths below refer to the repository state around
2026-01-15, after wiring the Stage 2 external host kernel into Phase 4
and rerunning the F1 FRW diagnostic scripts.

---

## 1. F1 sanity curve and mapping setup

The F1 baseline mapping is generated by:

- `phase4/src/phase4/run_f1_sanity.py`

Key configuration (from the latest run):

- `mapping_family`: `F1`
- `mapping_name`: `F1_baseline_v1`
- grid: `n_grid = 2048`, \(\theta \in [0, 2\pi]\)
- baseline diagnostics source:
  - `phase3/outputs/tables/mech_baseline_scan_diagnostics.json`
- effective floor (imported from Phase 3 diagnostics):
  - `epsfloor ≈ 0.0250973`
- sanity curve output:
  - `phase4/outputs/tables/phase4_F1_sanity_curve.csv`

Vacuum energy summary on this grid:

- \(E_\mathrm{vac, min} \approx 3.97\times 10^{-7}\)
- \(E_\mathrm{vac, max} \approx 1.11\times 10^{-5}\)
- \(E_\mathrm{vac, mean} \approx 4.59\times 10^{-6}\)

These numbers are toy, code–unit values; their role is to define a
shape and a relative floor, not a physical normalization.

---

## 2. F1 shape corridor (toy diagnostic)

The F1 “shape corridor” diagnostic is produced by:

- `phase4/src/phase4/run_f1_shape_diagnostics.py`

Outputs:

- diagnostics JSON:
  - `phase4/outputs/tables/phase4_F1_shape_diagnostics.json`
- per–\(\theta\) mask:
  - `phase4/outputs/tables/phase4_F1_shape_mask.csv`

Configuration and key results:

- corridor definition (toy, non–binding for claims):
  - \(E_\mathrm{vac}(\theta) \le E_\mathrm{vac,min} + k_\sigma \sigma\)
  - with `k_sigma = 1.0`
- global \(\theta\) range:
  - `theta_min_global = 0.0`
  - `theta_max_global ≈ 6.2801`
- fraction of grid in the toy corridor:
  - `corridor_fraction ≈ 0.5791`

So, in this configuration, roughly \(58\%\) of the F1 grid sits inside
the (diagnostic) shape corridor defined from the vacuum–energy curve.

---

## 3. F1 FRW viability backbone

The FRW toy viability backbone is generated by:

- `phase4/src/phase4/run_f1_frw_toy_diagnostics.py`

Inputs/assumptions:

- matter density: \(\Omega_m = 0.3\)
- radiation density: \(\Omega_r = 0.0\)
- target mean dark–energy fraction:
  - `omega_lambda_mean_target = 0.7`
- scale factor range: `a_min = 0.5`, `a_max = 1.0`, `n_a = 128`
- FRW sanity ratio cut:
  - `frw_sanity_ratio_max = 10.0`

Outputs:

- diagnostics JSON:
  - `phase4/outputs/tables/phase4_F1_frw_toy_diagnostics.json`
- per–\(\theta\) FRW mask:
  - `phase4/outputs/tables/phase4_F1_frw_toy_mask.csv`

Key summary values (from the JSON):

- `frac_viable ≈ 0.4961`  
  → about \(49.6\%\) of the grid is FRW–viable under the F1 mapping.
- `frac_has_matter_era = 1.0`  
  → every grid point has a proper matter era in this setup.
- `frac_has_late_accel ≈ 0.4961`  
  → late–time acceleration coincides with the viable subset here.
- age window:
  - `age_window_Gyr = [10.0, 20.0]`
  - `frac_age_window_ok = 1.0`
- global age range:
  - `age_Gyr_min ≈ 11.46`
  - `age_Gyr_max ≈ 16.48`
  - `age_Gyr_mean ≈ 14.20`

So the FRW toy backbone has:

- a broad viable set,
- reasonable ages (10–20 Gyr window fully populated), and
- the late–acceleration requirement aligned with viability in this
  configuration.

---

## 4. F1 FRW corridor summary

The FRW “corridor” extraction is done by:

- `phase4/src/phase4/run_f1_frw_corridors.py`

Inputs:

- FRW viability mask:
  - `phase4/outputs/tables/phase4_F1_frw_viability_mask.csv`

Outputs:

- corridor diagnostics:
  - `phase4/outputs/tables/phase4_F1_frw_corridors.json`
- per–\(\theta\) corridor CSV:
  - `phase4/outputs/tables/phase4_F1_frw_corridors.csv`

Key metadata:

- `n_grid = 2048`
- `n_viable = 1016`
- `viable_fraction ≈ 0.4961`
- number of FRW corridors:
  - `n_corridors = 1`

Principal corridor:

- `theta_min ≈ 0.4264`
- `theta_max ≈ 3.5404`
- `n_points = 1016`
- `omega_lambda_mean ≈ 1.3001` (toy–model value)

So the FRW backbone compresses into a single principal corridor in
\(\theta\) space, covering roughly \(0.43 \lesssim \theta \lesssim 3.54\)
with the current toy parameter choices.

---

## 5. \(\Lambda\)CDM–like FRW probe

The \(\Lambda\)CDM–like probe is generated by:

- `phase4/src/phase4/run_f1_frw_lcdm_probe.py`

Inputs:

- FRW viability mask:
  - `phase4/outputs/tables/phase4_F1_frw_viability_mask.csv`
- target cosmology:
  - `H0_km_s_Mpc = 70.0`
  - `omega_m = 0.3`
  - `omega_r = 0.0`
  - `omega_lambda_target = 0.7` with `omega_lambda_tolerance = 0.1`
  - `age_target_Gyr = 13.8` with `age_tolerance_Gyr = 1.0`

Outputs:

- diagnostics JSON:
  - `phase4/outputs/tables/phase4_F1_frw_lcdm_probe.json`
- \(\Lambda\)CDM–like mask:
  - `phase4/outputs/tables/phase4_F1_frw_lcdm_probe_mask.csv`

Key results:

- grid and counts:
  - `n_grid = 2048`
  - `n_frw_viable = 1016`
  - `n_lcdm_like = 63`
  - `lcdm_like_fraction ≈ 0.0308`
- \(\theta\) range of \(\Lambda\)CDM–like subset:
  - `theta_min_lcdm ≈ 0.5983`
  - `theta_max_lcdm ≈ 3.3625`
- \(\Omega_\Lambda\) range in the \(\Lambda\)CDM–like subset:
  - `omega_lambda_min_lcdm ≈ 0.6031`
  - `omega_lambda_max_lcdm ≈ 0.7982`
- age range in the \(\Lambda\)CDM–like subset:
  - `age_Gyr_min_lcdm ≈ 13.19`
  - `age_Gyr_max_lcdm ≈ 13.77`

Thus, about \(3\%\) of the full F1 grid is simultaneously:

- FRW–viable,
- within \(|\Omega_\Lambda - 0.7| \le 0.1\), and
- within \(|\mathrm{age} - 13.8\,\mathrm{Gyr}| \le 1.0\,\mathrm{Gyr}\).

This defines the internal \(\Lambda\)CDM–like corridor for F1 in this
baseline configuration.

---

## 6. Shape–FRW–\(\Lambda\)CDM overlaps

The combined shape/FRW/\(\Lambda\)CDM overlaps are summarized by:

- `phase4/src/phase4/run_f1_frw_shape_probe.py`

Output:

- `phase4/outputs/tables/phase4_F1_frw_shape_probe.json`

Key overlap fractions:

- total grid size:
  - `n_grid = 2048`
- `frac_in_toy_corridor ≈ 0.5791`
- `frac_frw_viable ≈ 0.4961`
- `frac_lcdm_like ≈ 0.0308`
- `frac_shape_and_viable ≈ 0.0752`
- `frac_shape_and_lcdm ≈ 0.0195`

Corresponding \(\theta\) ranges:

- FRW–viable:
  - `theta_range_frw_viable ≈ [0.4264, 3.5404]`
- in toy corridor:
  - `theta_range_in_toy_corridor ≈ [0.0, 6.2801]`
- \(\Lambda\)CDM–like:
  - `theta_range_lcdm_like ≈ [0.5983, 3.3625]`
- shape ∩ \(\Lambda\)CDM:
  - `theta_range_shape_and_lcdm ≈ [0.5983, 3.3625]`
- shape ∩ FRW–viable:
  - `theta_range_shape_and_viable ≈ [0.4264, 3.5404]`

In practice, the toy shape corridor is broad enough that the FRW–viable
and \(\Lambda\)CDM–like sets sit well inside it; the intersection ranges
coincide with the FRW and \(\Lambda\)CDM windows above.

---

## 7. Stage 2 external–cosmo host kernel and Phase 4

On the Stage 2 side, the external–cosmo host age–corridor kernel is
built and then exported to a Phase 4–ready constraints table via:

- kernel builder:
  - `stage2/external_cosmo_host/src/build_external_cosmo_host_age_anchor_corridor_kernel_v1.py`
- Phase 4 constraints export:
  - `stage2/external_cosmo_host/src/build_external_cosmo_host_phase4_constraints_v1.py`

Phase 4–ready summary table:

- `stage2/external_cosmo_host/outputs/tables/stage2_external_cosmo_host_phase4_constraints_v1.csv`

This file currently contains a single row with:

- `kernel_name = EXTERNAL_COSMO_HOST_AGE_CORRIDOR_KERNEL`
- `n_theta = 12`
- \(\theta\) span:
  - `theta_min ≈ 0.6412`
  - `theta_max ≈ 3.3195`
- internal (Phase 4 toy) \(\Omega_\Lambda\) range:
  - `omega_lambda_repo_min ≈ 0.6892`
  - `omega_lambda_repo_max ≈ 0.7230`
- host–side \(\Omega_\Lambda\) range:
  - `Omega_lambda_host_min ≈ 0.6892`
  - `Omega_lambda_host_max ≈ 0.7230`
- toy age range on kernel:
  - `age_Gyr_repo_min ≈ 13.40`
  - `age_Gyr_repo_max ≈ 13.50`
- host age range on kernel:
  - `age_Gyr_host_min ≈ 13.33`
  - `age_Gyr_host_max ≈ 13.77`
- mechanism baseline on kernel:
  - `mech_baseline_A0_min ≈ 0.04610`
  - `mech_baseline_A0_max ≈ 0.04665`

The kernel’s \(\theta\) span

- \([0.6412, 3.3195]\)

sits strictly inside the internal Phase 4 \(\Lambda\)CDM–like window

- \([0.5983, 3.3625]\),

and both are subsets of the FRW–viable corridor

- \([0.4264, 3.5404]\).

The \(\Omega_\Lambda\) and age ranges in the kernel are also comfortably
within the Phase 4 probe tolerances:

- \(\Omega_\Lambda \approx 0.69–0.72\) vs target \(0.7 \pm 0.1\),
- age \(\approx 13.4–13.5\,\mathrm{Gyr}\) (toy) and
  \(\approx 13.3–13.8\,\mathrm{Gyr}\) (host) vs target
  \(13.8 \pm 1\,\mathrm{Gyr}\).

This is exactly the corridor we want the external host to “see”: a
compact subset where:

1. Phase 4 FRW is viable,
2. the FRW toy sits inside its internal \(\Lambda\)CDM–like band,
3. the external host assigns a Universe–like age, and
4. the baseline mechanism parameter `mech_baseline_A0` stays
   in a narrow, representative band.

---

## 8. Data probe stub status

The FRW data–probe stub is wired but currently runs in “no–data” mode:

- script:
  - `phase4/src/phase4/run_f1_frw_data_probe.py`
- diagnostics:
  - `phase4/outputs/tables/phase4_F1_frw_data_probe.json`
- mask:
  - `phase4/outputs/tables/phase4_F1_frw_data_probe_mask.csv`

In the current repository configuration:

- external data path:
  - `phase4/data/external/frw_distance_binned.csv`
- the file exists only as a header/stub and is missing required columns
  `mu`, `sigma_mu`, `z`.
- result:
  - `data_available = false`
  - `n_data_points = 0`
  - `n_data_ok = 0`
  - `frac_data_ok_within_frw_viable = 0.0`

This is intentional for Phase 4: no real dataset is bundled; the data
probe is present as a reproducible hook that a future Stage can drive
with actual binned FRW distance measurements.

---

## 9. How to reuse this checkpoint

To reuse this checkpoint in future runs or external environments:

1. Rerun the F1 pipeline:

   ```bash
   oa && python phase4/src/phase4/run_f1_sanity.py
   oa && python phase4/src/phase4/run_f1_shape_diagnostics.py 
   oa && python phase4/src/phase4/run_f1_frw_toy_diagnostics.py
   oa && python phase4/src/phase4/run_f1_frw_corridors.py
   oa && python phase4/src/phase4/run_f1_frw_lcdm_probe.py
   oa && python phase4/src/phase4/run_f1_frw_data_probe.py
   ```

2. Regenerate the external host kernel summary:

   ```bash
   oa && python stage2/external_cosmo_host/src/build_external_cosmo_host_age_anchor_corridor_kernel_v1.py
   oa && python stage2/external_cosmo_host/src/build_external_cosmo_host_phase4_constraints_v1.py
   ```

3. Rebuild the Phase 4 external–host kernel LaTeX table:

   ```bash
   oa && python phase4/src/build_phase4_external_host_kernel_table_v1.py
   ```

If all scripts complete without error and the numeric ranges match (up
to expected floating–point noise), the Phase 4 F1 FRW baseline and its
Stage 2 host kernel alignment are successfully reproduced.
